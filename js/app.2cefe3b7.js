(function(t){function e(e){for(var n,s,i=e[0],c=e[1],u=e[2],l=0,d=[];l<i.length;l++)s=i[l],r[s]&&d.push(r[s][0]),r[s]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);f&&f(e);while(d.length)d.shift()();return o.push.apply(o,u||[]),a()}function a(){for(var t,e=0;e<o.length;e++){for(var a=o[e],n=!0,s=1;s<a.length;s++){var c=a[s];0!==r[c]&&(n=!1)}n&&(o.splice(e--,1),t=i(i.s=a[0]))}return t}var n={},r={app:0},o=[];function s(t){return i.p+"js/"+({about:"about"}[t]||t)+"."+{about:"3e3445bb"}[t]+".js"}function i(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.e=function(t){var e=[],a=r[t];if(0!==a)if(a)e.push(a[2]);else{var n=new Promise(function(e,n){a=r[t]=[e,n]});e.push(a[2]=n);var o,c=document.createElement("script");c.charset="utf-8",c.timeout=120,i.nc&&c.setAttribute("nonce",i.nc),c.src=s(t),o=function(e){c.onerror=c.onload=null,clearTimeout(u);var a=r[t];if(0!==a){if(a){var n=e&&("load"===e.type?"missing":e.type),o=e&&e.target&&e.target.src,s=new Error("Loading chunk "+t+" failed.\n("+n+": "+o+")");s.type=n,s.request=o,a[1](s)}r[t]=void 0}};var u=setTimeout(function(){o({type:"timeout",target:c})},12e4);c.onerror=c.onload=o,document.head.appendChild(c)}return Promise.all(e)},i.m=t,i.c=n,i.d=function(t,e,a){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(a,n,function(e){return t[e]}.bind(null,n));return a},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/mc2413/",i.oe=function(t){throw console.error(t),t};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],u=c.push.bind(c);c.push=e,c=c.slice();for(var l=0;l<c.length;l++)e(c[l]);var f=u;o.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"034f":function(t,e,a){"use strict";var n=a("64a9"),r=a.n(n);r.a},"21bb":function(t,e,a){"use strict";var n=a("bcc9"),r=a.n(n);r.a},5556:function(t,e,a){"use strict";var n=a("7c30"),r=a.n(n);r.a},"56d7":function(t,e,a){"use strict";a.r(e);a("744f"),a("6c7b"),a("7514"),a("20d6"),a("1c4c"),a("6762"),a("cadf"),a("e804"),a("55dd"),a("d04f"),a("c8ce"),a("217b"),a("7f7f"),a("f400"),a("7f25"),a("536b"),a("d9ab"),a("f9ab"),a("32d7"),a("25c9"),a("9f3c"),a("042e"),a("c7c6"),a("f4ff"),a("049f"),a("7872"),a("a69f"),a("0b21"),a("6c1a"),a("c7c62"),a("84b4"),a("c5f6"),a("2e37"),a("fca0"),a("7cdf"),a("ee1d"),a("b1b1"),a("87f3"),a("9278"),a("5df2"),a("04ff"),a("f751"),a("4504"),a("fee7"),a("ffc1"),a("0d6d"),a("9986"),a("8e6e"),a("25db"),a("e4f7"),a("b9a1"),a("64d5"),a("9aea"),a("db97"),a("66c8"),a("57f0"),a("165b"),a("456d"),a("cf6a"),a("fd24"),a("8615"),a("551c"),a("097d"),a("df1b"),a("2397"),a("88ca"),a("ba16"),a("d185"),a("ebde"),a("2d34"),a("f6b3"),a("2251"),a("c698"),a("a19f"),a("9253"),a("9275"),a("3b2b"),a("3846"),a("4917"),a("a481"),a("28a5"),a("386d"),a("6b54"),a("4f7f"),a("8a81"),a("ac4d"),a("8449"),a("9c86"),a("fa83"),a("48c0"),a("a032"),a("aef6"),a("d263"),a("6c37"),a("9ec8"),a("5695"),a("2fdb"),a("d0b0"),a("5df3"),a("b54a"),a("f576"),a("ed50"),a("788d"),a("14b9"),a("f386"),a("f559"),a("1448"),a("673e"),a("242a"),a("c66f"),a("b05c"),a("34ef"),a("6aa2"),a("15ac"),a("af56"),a("b6e4"),a("9c29"),a("63d9"),a("4dda"),a("10ad"),a("c02b"),a("4795"),a("130f"),a("ac6a"),a("96cf"),a("0cdd");var n=a("2b0e"),r=a("5f5b");a("c9c9"),a("2dd8");n["default"].use(r["a"]);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("div",[a("b-navbar",{staticClass:"mb-2",attrs:{type:"dark",variant:"dark"}},[a("b-navbar-brand",[t._v("MC2413")]),a("b-collapse",{attrs:{id:"nav-collapse","is-nav":""}},[a("b-navbar-nav",[a("b-nav-item",{attrs:{to:"/"}},[t._v("Home")]),a("b-nav-item",{attrs:{to:"/about"}},[t._v("About")])],1)],1)],1)],1),a("b-container",[a("router-view")],1)],1)},s=[],i={name:"root",mounted:function(){}},c=i,u=(a("034f"),a("2877")),l=Object(u["a"])(c,o,s,!1,null,null,null),f=l.exports,d=a("8c4f"),h=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"home"},[a("b-row",{staticClass:"mb-2 pianoroll-control"},[a("b-col",{attrs:{md:"2",lg:"1"}},[t._v("\n      scale:"+t._s(Number(t.pianoroll_scale).toFixed(2))+"\n    ")]),a("b-col",{attrs:{sm:"4"}},[a("b-form-input",{attrs:{type:"range",min:"0.5",max:"4",step:"0.25",variant:"secondary"},model:{value:t.pianoroll_scale,callback:function(e){t.pianoroll_scale=t._n(e)},expression:"pianoroll_scale"}})],1),a("b-col",{attrs:{sm:"4"}},[a("b-dropdown",{attrs:{text:"grid:"+t.pianoroll_quantize}},t._l(t.pianoroll_quantize_options,function(e){return a("b-dropdown-item",{key:e,on:{click:function(a){t.pianoroll_quantize=e}}},[t._v(t._s(e)+"\n        ")])}),1)],1)],1),a("piano-roll",{staticClass:"piano-roll mb-4",attrs:{scale:t.pianoroll_scale,quantize:t.pianoroll_quantize}}),a("mml-editor")],1)},p=[],b=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("codemirror",{ref:"cm",attrs:{value:t.code,options:t.cmOptions}})],1)},m=[],g=a("8f94"),_=(a("a7be"),a("8c2e"),a("56b3")),v=a.n(_);v.a.defineMode("text/mml",function(){return{token:function(t,e){return console.log(t),t.match("hoge")?"tag":t.match("moe")?"keyword":(t.next(),null)}}});var y={name:"mml-editor",components:{codemirror:g["codemirror"]},computed:{codemirror:function(){return this.$refs.cm.codemirror}},data:function(){return{code:"hoge hoge moemoe",cmOptions:{mode:"text/mml",theme:"base16-dark",lineNumbers:!0,line:!0}}},mounted:function(){this.initCodeMirror(this.codemirror)},methods:{initCodeMirror:function(t){}}},w=y,C=(a("cb7f"),Object(u["a"])(w,b,m,!1,null,null,null)),E=C.exports,x=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"wrapper",attrs:{ondragstart:"return false;",ondrop:"return false;"}},[a("svg",[a("defs",[a("pattern",{attrs:{id:"ptn-grid",width:t.quantize_width*t.quantize,height:"112",patternUnits:"userSpaceOnUse",patternContentUnits:"userSpaceOnUse",x:32+t.grid_offset}},t._l(t.util.range(t.quantize),function(e){return a("g",{key:e,attrs:{transform:t.getTransform(e*t.quantize_width,0)}},[a("rect",{staticClass:"a",attrs:{y:"0",width:t.quantize_width,height:"112"}}),a("rect",{staticClass:"b",attrs:{y:"10",width:t.quantize_width,height:"9"}}),a("rect",{staticClass:"b",attrs:{y:"28",width:t.quantize_width,height:"9"}}),a("rect",{staticClass:"b",attrs:{y:"46",width:t.quantize_width,height:"9"}}),a("rect",{staticClass:"b",attrs:{y:"74",width:t.quantize_width,height:"10"}}),a("rect",{staticClass:"b",attrs:{y:"94",width:t.quantize_width,height:"9"}}),a("line",{class:t.getLineClass(e,t.quantize),attrs:{x1:"0",y1:"0",x2:"0",y2:"112"}}),a("line",{staticClass:"d",attrs:{x1:"0",y1:"0",x2:t.quantize_width,y2:"0"}}),a("line",{staticClass:"c",attrs:{x1:"0",y1:"64",x2:t.quantize_width,y2:"64"}})])}),0)]),a("g",{attrs:{transform:t.getTransform(0,-1*t.stage_pos.y,t.scale)}},[a("rect",{attrs:{x:"32",width:t.stage_width,height:112*t.octaves,fill:"url(#ptn-grid)"},on:{mousedown:function(e){return t.onDrag("start",e)},mouseup:function(e){return t.onDrag("end",e)},mousemove:function(e){return t.onDrag("move",e)},wheel:function(e){return t.onDrag("wheel",e)}}}),a("g",{attrs:{id:"piano"}},t._l(t.util.range(t.octaves),function(e){return a("g",{key:"key-"+e,attrs:{transform:t.getTransform(0,112*(9-e)),"data-octave":e},on:{mousedown:function(e){return t.onKeyboard("down",e)},mousemove:function(e){return t.onKeyboard("move",e)},mouseup:function(e){return t.onKeyboard("up",e)},mouseout:function(e){return t.onKeyboard("out",e)}}},[a("rect",{staticClass:"a",attrs:{y:"96",width:"32",height:"16","data-note":"c"}}),a("rect",{staticClass:"a",attrs:{y:"80",width:"32",height:"16","data-note":"d"}}),a("rect",{staticClass:"a",attrs:{y:"64",width:"32",height:"16","data-note":"e"}}),a("rect",{staticClass:"a",attrs:{y:"48",width:"32",height:"16","data-note":"f"}}),a("rect",{staticClass:"a",attrs:{y:"32",width:"32",height:"16","data-note":"g"}}),a("rect",{staticClass:"a",attrs:{y:"16",width:"32",height:"16","data-note":"a"}}),a("rect",{staticClass:"a",attrs:{y:"0",width:"32",height:"16","data-note":"b"}}),a("rect",{staticClass:"b",attrs:{y:"94",width:"20",height:"8","data-note":"c#"}}),a("rect",{staticClass:"b",attrs:{y:"74",width:"20",height:"8","data-note":"d#"}}),a("rect",{staticClass:"b",attrs:{y:"46",width:"20",height:"8","data-note":"f#"}}),a("rect",{staticClass:"b",attrs:{y:"28",width:"20",height:"8","data-note":"g#"}}),a("rect",{staticClass:"b",attrs:{y:"10",width:"20",height:"8","data-note":"a#"}}),a("text",{staticClass:"c",attrs:{transform:"translate(22 108)"}},[t._v("C"+t._s(e))])])}),0)])])])},T=[],k=a("2ef0"),S=a.n(k),O={name:"piano-roll",props:{scale:{type:Number,default:2},quantize:{type:Number,default:8}},data:function(){return{util:S.a,octaves:10,stage_pos:{x:0,y:0},stage_width:1e4,last_pos:null}},mounted:function(){window.addEventListener("resize",this.updateStageWidth),this.updateStageWidth()},beforeDestroy:function(){window.removeEventListener("resize",this.updateStageWidth)},computed:{quantize_width:function(){return 256/this.quantize},grid_offset:function(){return this.stage_pos.x%(this.quantize_width*this.quantize)*-1}},watch:{scale:function(t,e){this.stage_pos.x*=t/e,this.stage_pos.y*=t/e,this.updateStageWidth()}},methods:{getTransform:function(t,e,a){var n="";return null!==t&&null!==e&&(n+="translate(".concat(t,",").concat(e,")")),a&&(n+=" scale(".concat(a,")")),n},getLineClass:function(t,e){return 0==t?"measure":t%(e/4)==0?"beat":"tick"},onDrag:function(t,e){switch(t){case"start":this.last_pos={x:e.offsetX,y:e.offsetY};break;case"move":e.buttons||(this.last_pos=null),null!==this.last_pos&&(this.setStagePos(this.stage_pos.x+(this.last_pos.x-e.offsetX)/this.scale,this.stage_pos.y+(this.last_pos.y-e.offsetY)/this.scale),this.last_pos={x:e.offsetX,y:e.offsetY});break;case"end":this.last_pos=null;break;case"wheel":this.setStagePos(this.stage_pos.x,this.stage_pos.y+e.deltaY/2/this.scale);break}},onKeyboard:function(t,e){var a=e.target.dataset.note+e.target.parentNode.dataset.octave;switch(t){case"down":this.$store.dispatch("KEYON_TEST",a);break;case"up":this.$store.dispatch("KEYOFF_TEST");break;case"move":e.buttons&&this.$store.dispatch("KEYON_TEST",a);break;case"out":this.$store.dispatch("KEYOFF_TEST");break}},updateStageWidth:function(){this.stage_width=this.$refs.wrapper.offsetWidth/this.scale},setStagePos:function(t,e){this.stage_pos.x=Math.max(0,t),this.stage_pos.y=Math.min(Math.max(0,e),1120*this.scale-this.$refs.wrapper.offsetHeight)}}},z=O,q=(a("5556"),Object(u["a"])(z,x,T,!1,null,null,null)),P=q.exports,j={name:"home",components:{MmlEditor:E,PianoRoll:P},data:function(){return{pianoroll_scale:2,pianoroll_quantize:16,pianoroll_quantize_options:[32,24,16,12,9,8,4,3,2,1]}}},M=j,D=(a("21bb"),Object(u["a"])(M,h,p,!1,null,null,null)),N=D.exports;n["default"].use(d["a"]);var U=new d["a"]({routes:[{path:"/",name:"home",component:N},{path:"/about",name:"about",component:function(){return a.e("about").then(a.bind(null,"f820"))}}]}),$=a("2f62"),K=a("8cc4"),A=a.n(K);function Y(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function F(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function L(t,e,a){return e&&F(t.prototype,e),a&&F(t,a),t}var W=function(){function t(){Y(this,t),this.channel=new A.a.Channel({volume:-20}).toMaster(),this.tone=new A.a.Synth({oscillator:{type:"sine"}}).connect(this.channel)}return L(t,[{key:"keyOn",value:function(t,e){this.tone.triggerAttack(t,e)}},{key:"keySet",value:function(t,e){this.tone.setNote(t,e)}},{key:"keyOff",value:function(t){this.tone.triggerRelease(t)}}]),t}(),H=new W,X=function(t){t.subscribe(function(t,e){if("UPDATE_TEST"==t.type){var a=t.payload;a?H.keyOn(a):H.keyOff()}})},J=X;n["default"].use($["a"]);var Q=new $["a"].Store({plugins:[J],state:{test_tone:null},mutations:{UPDATE_TEST:function(t,e){t.test_tone=e},UPDATE_SEQUENCE:function(t,e){}},actions:{KEYON_TEST:function(t,e){e!=t.state.test_tone&&t.commit("UPDATE_TEST",e)},KEYOFF_TEST:function(t){t.state.test_tone&&t.commit("UPDATE_TEST",null)},CHANGE_MML:function(t,e){t.commit("UPDATE_SEQUNCE",e)}}});n["default"].config.productionTip=!1,new n["default"]({router:U,store:Q,render:function(t){return t(f)}}).$mount("#app")},"64a9":function(t,e,a){},"7c30":function(t,e,a){},bcc9:function(t,e,a){},c9c9:function(t,e,a){},cb7f:function(t,e,a){"use strict";var n=a("d316"),r=a.n(n);r.a},d316:function(t,e,a){}});
//# sourceMappingURL=app.2cefe3b7.js.map